<!doctype html><html lang="en"><head><meta charset="utf-8"/><link rel="icon" href="/DataViz-FinalProject/favicon.ico"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta name="theme-color" content="#000000"/><meta name="description" content="Web site created using create-react-app"/><link rel="apple-touch-icon" href="/DataViz-FinalProject/logo192.png"/><link rel="manifest" href="/DataViz-FinalProject/manifest.json"/><script src="https://d3js.org/d3.v3.min.js"></script><title>React App</title><link href="/DataViz-FinalProject/static/css/main.5794acd6.chunk.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"></div><div id="bars"></div><script>var width = 500,//660,
        height =  500,//550,
        radius = (Math.min(width, height) / 2)-10;

      function updateSunburst(newValue){
        d3.selectAll(".sunburst-d3").remove();
        d3.selectAll(".tooltip").remove();
        init();
        if (newValue === 1){
          asd("chazelle_sort.json")
        } else if (newValue === 2){
          asd("miyazaki.json")
        } else if (newValue === 3){
          asd("takahata.json")
        } else if (newValue === 4){
          asd("bondarchuk.json")
        }
      }
      
      function init()
      {
        formatNumber = d3.format(",d");
    
        x = d3.scale
          .linear()
          .range([0, 2 * Math.PI]);
    
        y = d3.scale
          .sqrt()
          .range([0, radius]);
    
        color = d3.scale.category20c();
    
        partition = d3.layout.partition()
        .value(function(d) { return d.size; });
    
        arc = d3.svg.arc()
        .startAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, x(d.x))); })
        .endAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, x(d.x + d.dx))); })
        .innerRadius(function(d) { return Math.max(0, y(d.y)); })
        .outerRadius(function(d) { return Math.max(0, y(d.y + d.dy)); });
    
        const svgCounter = document.querySelectorAll(".sunburst-d3").length;

        if (svgCounter === 0) {
          svg = d3.select("body")
            .append("svg")
              .attr("class", "sunburst-d3")
            .append("g")
              .attr("transform", "translate(250, 250)");
          
          div = d3.select("body")
            .append("div")
              .attr("class", "tooltip")
              .style("opacity", 1e-6);
        }
      }
      
      init()
      asd("chazelle_sort.json")
      function asd(select_jason)
      {
          d3.json(select_jason, function(error, root) {
            if (error) throw error;

            // Sort colors circle
            root.children.forEach(function(son) {
              son.children.forEach(function(grandchild) {
                var palette = [];
                grandchild.children.forEach(function(greatgrandson){
                  palette.push(greatgrandson.color); 
                });
                palette=[...new Set(palette)];
                var rgbArr = palette.map(hexToRgb);
                var sortedRgbArr = sortColors(rgbArr);
                var finalArrayPalette = sortedRgbArr.map(rgbToHex);
                var i = 0;
                grandchild.children.forEach(function(greatgrandson){
                  greatgrandson.color=finalArrayPalette[i]; 
                  i++;
                });
              });
            });
        
            svg.selectAll("path")
                .data(partition.nodes(root))
                .enter().append("path")
                .attr("d", arc)
                .style("fill", function(d) { return color1(d);})
                .on("click", click)
                .on("auxclick", auxclick)
                .on("mouseover", mouseover)
                .on("mousemove", mousemove)
                .on("mouseout", mouseout)
                // .append("title")
                // .text(function(d) { if (d.year){return "Name : " + d.name + "\n" + "Box Office : " + formatNumber(d.size) +"$"+"\n" + "Year : " + formatNumber(d.year);} else {return d.name }});
          });
      }
      function color1(d)
        {
        if(!d.color)
        { 
          //return "blue";
          //return color(d.name);
          if(d.name=="Romance")
            return "#D31360";
          else if(d.name=="Drama")
            return "#6E6E6E";
          else if(d.name=="Musical")
            return "#8904B1";
          else if(d.name=="Animation")
            return "#5882FA";
          else if(d.name=="Indie")
            return "#2EFEC8";
          else if(d.name=="Sci-fi")
            return "#04B404";
          else if(d.name=="Comedy")
            return "#F7FE2E";
          else if(d.name=="Action")
            return "#0000FF";
          else if(d.name=="Noir")
            return "#585858";
          else if(d.name=="Horror")
            return "#000000";
          else if(d.name=="Documental")
            return "#088A4B";
          else
            return color(d.name);
        }
        else
        {
          return d.color;
          //return color(d.name);
          //return "blue";
        }
      }
      
      function mouseover(d)
      {
          if(d.year)
          {
              div.transition()
            .duration(500)
            .style("opacity", 1);
          }
      }
      function mousemove(d)
      {
          if(d.poster)
          {
              div
              .html("<img src='"+d.poster+"' style='height:215px;width:150px;'>")
                  .style("left", (d3.event.pageX - 10) + "px")
                  .style("top", (d3.event.pageY - 200) + "px");
          }
          if(d.scene)
          {
              div
              .html("<img src='"+d.scene+"' style='height:180px;width:460px;'>")
                  .style("left", (d3.event.pageX - 10) + "px")
                  .style("top", (d3.event.pageY - 200) + "px");
          }
      }
      function mouseout(d)
      {
          if(d.year)
          {
              div.transition()
            .duration(500)
            .style("opacity", 1e-6);
          }
      }
      
      function click(d) {
        svg.transition()
            .duration(750)
            .tween("scale", function() {
              var xd = d3.interpolate(x.domain(), [d.x, d.x + d.dx]),
                  yd = d3.interpolate(y.domain(), [d.y, 1]),
                  yr = d3.interpolate(y.range(), [d.y ? 20 : 0, radius]);
              return function(t) { x.domain(xd(t)); y.domain(yd(t)).range(yr(t)); };
            })
          .selectAll("path")
            .attrTween("d", function(d) { return function() { return arc(d); }; });
      }

      function auxclick(d) {
        if(d.scene)
        {
          // Define limit of scenes
          if (document.getElementById("bars").children.length < 5) {
            //Get colors and sort them
            var palette = [];
            for (let element of d.children) {
              palette.push(element.color); 
            }
            appendScene(d.scene, "bars", d.scene, palette);
          }
        }
      }

      function appendScene(imageSource, containerId, imageId, palette) {
        if(document.getElementById(imageId) == null){ 
          //Create Div
          var newDiv = document.createElement("div");
          document.getElementById(containerId).appendChild(newDiv);

          //Append image
          var img = document.createElement("IMG");
          img.src = imageSource;
          img.setAttribute('id', imageId);
          img.setAttribute('width', 368);
          img.setAttribute('height', 144);
          img.setAttribute("style", "margin-right: 20px; border-radius: 15px;");
          newDiv.appendChild(img);

          //Sort colors
          var rgbArr = palette.map(hexToRgb);
          var sortedRgbArr = sortColors(rgbArr);
          var finalArrayPalette = sortedRgbArr.map(rgbToHex);

          //Append colors
          finalArrayPalette.forEach(function(color) {
            var svg_rect = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            svg_rect.setAttribute('width', 40);
            svg_rect.setAttribute('height',144);
            svg_rect.style.background = color;
            newDiv.appendChild(svg_rect);
          });

          //Append Remove button
          var button = document.createElement("button");
          button.innerHTML = "Remove";
          button.onclick = function(){
            newDiv.parentNode.removeChild(newDiv);
            return false;
          };
          newDiv.appendChild(button);
          return imageId;
        }    
      }

      //Sort colors functions
      function hexToRgb(hex) {
        hex = hex.substring(1, hex.length);
        var r = parseInt((hex).substring(0, 2), 16);
        var g = parseInt((hex).substring(2, 4), 16);
        var b = parseInt((hex).substring(4, 6), 16);
        
        return [r, g, b];
      }

      function rgbToHex(rgb) {
        return "#" + ((1 << 24) + (rgb[0] << 16) + (rgb[1] << 8) + rgb[2]).toString(16).slice(1);
      }

      function colorDistance(color1, color2) {
        // This is actually the square of the distance but
        // this doesn't matter for sorting.
        var result = 0;
        for (var i = 0; i < color1.length; i++)
            result += (color1[i] - color2[i]) * (color1[i] - color2[i]);
        return result;
      }

      function sortColors(colors) {
          // Calculate distance between each color
          var distances = [];
          for (var i = 0; i < colors.length; i++) {
              distances[i] = [];
              for (var j = 0; j < colors.length; j++)
                  distances.push([colors[i], colors[j], colorDistance(colors[i], colors[j])]);
          }
          distances.sort(function(a, b) {
              return a[2] - b[2];
          });

          // Put each color into separate cluster initially
          var colorToCluster = {};
          for (var i = 0; i < colors.length; i++)
              colorToCluster[colors[i]] = [colors[i]];

          // Merge clusters, starting with lowest distances
          var lastCluster;
          for (var i = 0; i < distances.length; i++) {
              var color1 = distances[i][0];
              var color2 = distances[i][1];
              var cluster1 = colorToCluster[color1];
              var cluster2 = colorToCluster[color2];
              if (!cluster1 || !cluster2 || cluster1 == cluster2)
                  continue;

              // Make sure color1 is at the end of its cluster and
              // color2 at the beginning.
              if (color1 != cluster1[cluster1.length - 1])
                  cluster1.reverse();
              if (color2 != cluster2[0])
                  cluster2.reverse();
       
              // Merge cluster2 into cluster1
              cluster1.push.apply(cluster1, cluster2);
              delete colorToCluster[color1];
              delete colorToCluster[color2];
              colorToCluster[cluster1[0]] = cluster1;
              colorToCluster[cluster1[cluster1.length - 1]] = cluster1;
              lastCluster = cluster1;
          }
          var last = colors.length-1
          if(lastCluster[0][0]+lastCluster[0][1]+lastCluster[0][2]>lastCluster[last][0]+lastCluster[last][1]+lastCluster[last][2])
          {
            lastCluster.reverse();
          }

          // By now all colors should be in one cluster
          return lastCluster;
      }

      
      d3.select(self.frameElement).style("height", height + "px");
      d3.select("body").style("background-color","white")</script><style>div.tooltip{position:absolute;text-align:center;width:20px;height:33px;padding:8px;font:10px sans-serif;border-radius:8px;pointer-events:none}</style><script>!function(c){function e(e){for(var t,r,n=e[0],o=e[1],u=e[2],i=0,a=[];i<n.length;i++)r=n[i],f[r]&&a.push(f[r][0]),f[r]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(c[t]=o[t]);for(d&&d(e);a.length;)a.shift()();return p.push.apply(p,u||[]),l()}function l(){for(var e,t=0;t<p.length;t++){for(var r=p[t],n=!0,o=1;o<r.length;o++){var u=r[o];0!==f[u]&&(n=!1)}n&&(p.splice(t--,1),e=s(s.s=r[0]))}return e}var r={},f={3:0},p=[];function s(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.e=function(u){var e=[],r=f[u];if(0!==r)if(r)e.push(r[2]);else{var t=new Promise(function(e,t){r=f[u]=[e,t]});e.push(r[2]=t);var n,o=document.getElementsByTagName("head")[0],i=document.createElement("script");i.charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.src=s.p+"static/js/"+({}[u]||u)+"."+{1:"ad39ee43"}[u]+".chunk.js",n=function(e){i.onerror=i.onload=null,clearTimeout(a);var t=f[u];if(0!==t){if(t){var r=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src,o=new Error("Loading chunk "+u+" failed.\n("+r+": "+n+")");o.type=r,o.request=n,t[1](o)}f[u]=void 0}};var a=setTimeout(function(){n({type:"timeout",target:i})},12e4);i.onerror=i.onload=n,o.appendChild(i)}return Promise.all(e)},s.m=c,s.c=r,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(r,n,function(e){return t[e]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/DataViz-FinalProject/",s.oe=function(e){throw console.error(e),e};var t=window.webpackJsonp=window.webpackJsonp||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var d=n;l()}([])</script><script src="/DataViz-FinalProject/static/js/2.f2d96927.chunk.js"></script><script src="/DataViz-FinalProject/static/js/main.bb3e908e.chunk.js"></script></body></html>